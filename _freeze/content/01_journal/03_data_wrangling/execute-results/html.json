{
  "hash": "16069e0275893e805434398259d9bf70",
  "result": {
    "markdown": "---\ntitle: \"Data Wrangling\"\nauthor: \"Joschka Schwarz\"\n---\n\n\n::: callout-note\nData Wrangling\n:::\n\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-1_5f019da9427f61a258c5dfe155713c1a'}\n\n```{.r .cell-code}\n#load the tables\n\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.2     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.0\n#> ✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.1     \n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(vroom)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'vroom'\n#> \n#> The following objects are masked from 'package:readr':\n#> \n#>     as.col_spec, col_character, col_date, col_datetime, col_double,\n#>     col_factor, col_guess, col_integer, col_logical, col_number,\n#>     col_skip, col_time, cols, cols_condense, cols_only, date_names,\n#>     date_names_lang, date_names_langs, default_locale, fwf_cols,\n#>     fwf_empty, fwf_positions, fwf_widths, locale, output_column,\n#>     problems, spec\n```\n:::\n\n```{.r .cell-code}\nlibrary(lubridate)\nlibrary(data.table)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'data.table'\n#> \n#> The following objects are masked from 'package:lubridate':\n#> \n#>     hour, isoweek, mday, minute, month, quarter, second, wday, week,\n#>     yday, year\n#> \n#> The following objects are masked from 'package:dplyr':\n#> \n#>     between, first, last\n#> \n#> The following object is masked from 'package:purrr':\n#> \n#>     transpose\n```\n:::\n\n```{.r .cell-code}\n# load the column list\ncol_types_patent <- list(\n  id = col_character(),\n  date = col_date(\"%Y-%m-%d\"),\n  num_claims = col_double()\n  )\n\ncol_types_patent_asignee <- list(\n  patent_id = col_character(),\n  assignee_id = col_character()\n  )\n\ncol_types_asignee <- list(\n  id = col_character(),\n  type = col_double(),\n  organization = col_character()\n  )\n\ncol_types_uspc <- list(\n  patent_id = col_character(),\n  mainclass_id = col_character(),\n  sequence = col_double()\n  )\n\n#Acquire data from the files\npatent_tbl <- vroom(\n  file       = \"Patent_data_reduced/patent.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types_patent,\n  na         = c(\"\", \"NA\", \"NULL\")\n  )\n\npatent_asignee_tbl <- vroom(\n  file       = \"Patent_data_reduced/patent_assignee.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types_patent_asignee,\n  na         = c(\"\", \"NA\", \"NULL\")\n  )\n\nasignee_tbl <- vroom(\n  file       = \"Patent_data_reduced/assignee.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types_asignee,\n  na         = c(\"\", \"NA\", \"NULL\")\n  )\n\nuspc_tbl <- vroom(\n  file       = \"Patent_data_reduced/uspc.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types_uspc,\n  na         = c(\"\", \"NA\", \"NULL\")\n  )\n\n#Convert the aquired data to data table\nsetDT(patent_tbl)\nsetDT(patent_asignee_tbl)\nsetDT(asignee_tbl)\nsetDT(uspc_tbl)\n\n#merge asignee data\ncombined_asignee_data <- merge(x=patent_asignee_tbl,y=asignee_tbl,\n                               by.x=\"assignee_id\",\n                               by.y = \"id\",\n                               all.x = TRUE,\n                               all.y = FALSE)\n```\n:::\n\n\n## Top 10 US Orgs with most patents#type 2 is for US Companies\n\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-2_1cb78127607a2b8d9b48438b150a9048'}\n\n```{.r .cell-code}\n#Top 10 US Orgs with most patents#type 2 is for US Companies\ncombined_asignee_data[type==2,.N,by=organization][order( \n  N,decreasing = TRUE)]%>% \n  slice(1:10)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"organization\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"N\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"International Business Machines Corporation\",\"2\":\"7547\"},{\"1\":\"Microsoft Corporation\",\"2\":\"3165\"},{\"1\":\"Google Inc.\",\"2\":\"2668\"},{\"1\":\"QUALCOMM Incorporated\",\"2\":\"2597\"},{\"1\":\"Apple Inc.\",\"2\":\"2201\"},{\"1\":\"General Electric Company\",\"2\":\"1873\"},{\"1\":\"Hewlett-Packard Development Company, L.P.\",\"2\":\"1638\"},{\"1\":\"AT&T INTELLECTUAL PROPERTY I, L.P.\",\"2\":\"1625\"},{\"1\":\"Intel Corporation\",\"2\":\"1616\"},{\"1\":\"GM Global Technology Operations LLC\",\"2\":\"1533\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n## US Orgs with most patents in Aug 2014\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-3_4db64b14bb4e1c98ca6e601b75d0e243'}\n\n```{.r .cell-code}\ncombined_patent_data <- merge(x=patent_tbl,y=combined_asignee_data,\n                              by.x = \"id\",\n                              by.y = \"patent_id\",\n                              all.x = TRUE,\n                              all.y = FALSE) %>% filter(!is.na(assignee_id))\n\n\nsetnames(combined_patent_data,\"date\",\"GrantDate\")\n\n\n#US Orgs with most patents in Aug 2014\nMostPatentsAugust14 <- combined_patent_data[month(GrantDate)==8 & type==2,.N,by=organization][order(\n  N,decreasing = TRUE)] %>% head(1)\nMostPatentsAugust14\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"organization\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"N\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"International Business Machines Corporation\",\"2\":\"718\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Top 10 Companies with Most New Patents August 2014\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-4_411756c956cebb12508bf7eb665150f3'}\n\n```{.r .cell-code}\nT10_Latest_patents <- combined_patent_data[month(GrantDate)==8&type==2,.N,by=.(GrantDate,organization)][order(GrantDate,N,decreasing = TRUE)] %>% \n  slice(1:10)\nT10_Latest_patents\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"GrantDate\"],\"name\":[1],\"type\":[\"date\"],\"align\":[\"right\"]},{\"label\":[\"organization\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"N\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"2014-08-26\",\"2\":\"International Business Machines Corporation\",\"3\":\"157\"},{\"1\":\"2014-08-26\",\"2\":\"Microsoft Corporation\",\"3\":\"78\"},{\"1\":\"2014-08-26\",\"2\":\"Google Inc.\",\"3\":\"73\"},{\"1\":\"2014-08-26\",\"2\":\"Apple Inc.\",\"3\":\"57\"},{\"1\":\"2014-08-26\",\"2\":\"QUALCOMM Incorporated\",\"3\":\"48\"},{\"1\":\"2014-08-26\",\"2\":\"GM Global Technology Operations LLC\",\"3\":\"42\"},{\"1\":\"2014-08-26\",\"2\":\"General Electric Company\",\"3\":\"41\"},{\"1\":\"2014-08-26\",\"2\":\"Intel Corporation\",\"3\":\"41\"},{\"1\":\"2014-08-26\",\"2\":\"AT&T INTELLECTUAL PROPERTY I, L.P.\",\"3\":\"37\"},{\"1\":\"2014-08-26\",\"2\":\"Hewlett-Packard Development Company, L.P.\",\"3\":\"30\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Most Innovative Tech Sector\nHere I have given the Class ID of the most innovative Tech Sector\n\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-5_63e0941457b63e8a19981dc0c2c874d6'}\n\n```{.r .cell-code}\n#combine uspc_tbl with asignee_tbl and patent_asignee_tbl\nuspc_combined <- merge(x=uspc_tbl,y=combined_asignee_data,\n                       by=\"patent_id\",\n                       all.x=TRUE,\n                       all.y = FALSE)  %>% filter(!is.na(assignee_id))  \n#most innovative tech category is the class with most patents\nmost_innovative <- uspc_combined[,.N,by=mainclass_id][order(N,decreasing = TRUE)] %>% head(1)\nmost_innovative\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"mainclass_id\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"N\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"257\",\"2\":\"41500\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Top 10 orgs with the most patents worldwide\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-6_7b3590895c57dce6a108b130fee94f85'}\n\n```{.r .cell-code}\n#top 10 orgs with the most patents\ntop10Worldwide <- uspc_combined[type==3|type==2,.N,by=.(organization)][order(N,decreasing = TRUE)] %>% slice(1:10)\ntop10Worldwide\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"organization\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"N\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"International Business Machines Corporation\",\"2\":\"19056\"},{\"1\":\"Samsung Electronics Co., Ltd.\",\"2\":\"14523\"},{\"1\":\"Canon Kabushiki Kaisha\",\"2\":\"9467\"},{\"1\":\"Sony Corporation\",\"2\":\"8372\"},{\"1\":\"QUALCOMM Incorporated\",\"2\":\"7322\"},{\"1\":\"Microsoft Corporation\",\"2\":\"7195\"},{\"1\":\"Kabushiki Kaisha Toshiba\",\"2\":\"6957\"},{\"1\":\"Google Inc.\",\"2\":\"6082\"},{\"1\":\"LG Electronics Inc.\",\"2\":\"5694\"},{\"1\":\"Panasonic Corporation\",\"2\":\"5641\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n#vector of the top 10 orgs\ntop10orgs <-top10Worldwide %>%  pull(organization)\ntop10orgs\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>  [1] \"International Business Machines Corporation\"\n#>  [2] \"Samsung Electronics Co., Ltd.\"              \n#>  [3] \"Canon Kabushiki Kaisha\"                     \n#>  [4] \"Sony Corporation\"                           \n#>  [5] \"QUALCOMM Incorporated\"                      \n#>  [6] \"Microsoft Corporation\"                      \n#>  [7] \"Kabushiki Kaisha Toshiba\"                   \n#>  [8] \"Google Inc.\"                                \n#>  [9] \"LG Electronics Inc.\"                        \n#> [10] \"Panasonic Corporation\"\n```\n:::\n:::\n\n\n## top 5 USPTO tech main classes for the top 10 companies worldwide\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-7_25a3361bc5eea8656b1dbd070dd08ee4'}\n\n```{.r .cell-code}\n#the classes of the the top 10 orgs\nuspc_combined[ifelse(organization %in% top10orgs,TRUE,FALSE),.N,by=mainclass_id][order(N,decreasing = TRUE)] %>% \n  slice(1:5)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"mainclass_id\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"N\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"257\",\"2\":\"7979\"},{\"1\":\"455\",\"2\":\"6191\"},{\"1\":\"370\",\"2\":\"5483\"},{\"1\":\"348\",\"2\":\"4113\"},{\"1\":\"709\",\"2\":\"4018\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}